# é‡æ–°ç»„ç»‡åçš„é¡¹ç›®ç»“æ„

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
backend-python/
â”œâ”€â”€ app.py                      # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ database.py                 # æ•°æ®åº“æ“ä½œ
â”œâ”€â”€ requirements.txt            # ç”Ÿäº§ä¾èµ–
â”œâ”€â”€ test_requirements.txt       # æµ‹è¯•ä¾èµ–
â”œâ”€â”€ pytest.ini                 # pytesté…ç½®
â”œâ”€â”€ run_tests.sh               # æµ‹è¯•è¿è¡Œè„šæœ¬
â”œâ”€â”€ manage.sh                  # åº”ç”¨ç®¡ç†è„šæœ¬
â”œâ”€â”€ production.py              # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ TESTING_GUIDE.md           # æµ‹è¯•æŒ‡å—
â”œâ”€â”€ TEST_SUMMARY.md            # æµ‹è¯•æ‘˜è¦
â”œâ”€â”€ COMPARISON.md              # ä¸Node.jså¯¹æ¯”
â”œâ”€â”€ test_report_template.md    # æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿
â”œâ”€â”€ db/                        # æ•°æ®åº“æ–‡ä»¶
â”‚   â””â”€â”€ quote.db              # SQLiteæ•°æ®åº“
â””â”€â”€ tests/                     # æµ‹è¯•ç›®å½• â­
    â”œâ”€â”€ __init__.py           # æµ‹è¯•åŒ…åˆå§‹åŒ–
    â”œâ”€â”€ conftest.py           # æµ‹è¯•é…ç½®å’Œfixtures
    â”œâ”€â”€ test_data_factory.py  # æµ‹è¯•æ•°æ®å·¥å‚
    â”œâ”€â”€ test_database.py      # æ•°æ®åº“å•å…ƒæµ‹è¯•
    â”œâ”€â”€ test_api.py           # APIç«¯ç‚¹æµ‹è¯•
    â”œâ”€â”€ test_security.py      # å®‰å…¨æ€§æµ‹è¯•
    â”œâ”€â”€ test_performance.py   # æ€§èƒ½æµ‹è¯•
    â””â”€â”€ test_edge_cases.py    # è¾¹ç•Œæµ‹è¯•
```

## ğŸ¯ æ–°ç»“æ„çš„ä¼˜åŠ¿

### 1. **æ›´æ¸…æ™°çš„ç»„ç»‡**
- âœ… æµ‹è¯•æ–‡ä»¶ä¸æºä»£ç åˆ†ç¦»
- âœ… éµå¾ªPythoné¡¹ç›®æ ‡å‡†ç»“æ„
- âœ… ä¾¿äºIDEå’Œå·¥å…·è¯†åˆ«

### 2. **æ›´å¥½çš„å¯ç»´æŠ¤æ€§**
- âœ… æµ‹è¯•æ–‡ä»¶é›†ä¸­ç®¡ç†
- âœ… æ˜“äºæ·»åŠ æ–°æµ‹è¯•
- âœ… ä¾¿äºå›¢é˜Ÿåä½œ

### 3. **æ ‡å‡†åŒ–**
- âœ… ç¬¦åˆpytestæœ€ä½³å®è·µ
- âœ… éµå¾ªPython PEP 8è§„èŒƒ
- âœ… ä¾¿äºCI/CDé›†æˆ

## ğŸš€ è¿è¡Œæµ‹è¯•

### ä½¿ç”¨ä¾¿æ·è„šæœ¬
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
./run_tests.sh all

# è¿è¡Œç‰¹å®šç±»å‹æµ‹è¯•
./run_tests.sh unit        # å•å…ƒæµ‹è¯•
./run_tests.sh integration # é›†æˆæµ‹è¯•
./run_tests.sh security    # å®‰å…¨æµ‹è¯•
./run_tests.sh performance # æ€§èƒ½æµ‹è¯•

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
./run_tests.sh coverage
```

### ç›´æ¥ä½¿ç”¨pytest
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
python -m pytest tests/test_api.py

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
python -m pytest tests/test_api.py::TestAPI

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•
python -m pytest tests/test_api.py::TestAPI::test_register_success

# è¯¦ç»†è¾“å‡º
python -m pytest -v

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
python -m pytest --cov=app --cov=database --cov-report=html
```

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶è¯´æ˜

### ğŸ”§ æ ¸å¿ƒæµ‹è¯•æ–‡ä»¶

| æ–‡ä»¶ | æè¿° | æµ‹è¯•æ•°é‡ |
|------|------|----------|
| `test_database.py` | æ•°æ®åº“ç›¸å…³åŠŸèƒ½æµ‹è¯• | 4ä¸ª |
| `test_api.py` | APIç«¯ç‚¹å’Œé›†æˆæµ‹è¯• | 14ä¸ª |
| `test_security.py` | å®‰å…¨æ€§å’Œæ¼æ´æµ‹è¯• | 10ä¸ª |
| `test_performance.py` | æ€§èƒ½å’Œè´Ÿè½½æµ‹è¯• | 8ä¸ª |
| `test_edge_cases.py` | è¾¹ç•Œå’Œå¼‚å¸¸æµ‹è¯• | 15ä¸ª+ |

### ğŸ› ï¸ è¾…åŠ©æ–‡ä»¶

| æ–‡ä»¶ | æè¿° | åŠŸèƒ½ |
|------|------|------|
| `conftest.py` | æµ‹è¯•é…ç½®å’Œå…±äº«fixtures | æµ‹è¯•ç¯å¢ƒè®¾ç½® |
| `test_data_factory.py` | æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨ | éšæœºæ•°æ®ç”Ÿæˆ |
| `__init__.py` | åŒ…åˆå§‹åŒ–æ–‡ä»¶ | åŒ…æ ‡è¯† |

## ğŸ”„ å¯¼å…¥è·¯å¾„å¤„ç†

åœ¨æ–°çš„ç»“æ„ä¸­ï¼Œæ‰€æœ‰æµ‹è¯•æ–‡ä»¶éƒ½æ­£ç¡®å¤„ç†äº†å¯¼å…¥è·¯å¾„ï¼š

```python
# åœ¨æµ‹è¯•æ–‡ä»¶ä¸­æ·»åŠ çˆ¶ç›®å½•åˆ°è·¯å¾„
import sys
import os
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

# ç„¶åæ­£å¸¸å¯¼å…¥åº”ç”¨æ¨¡å—
from app import app
from database import init_database
```

## ğŸ“Š pytesté…ç½®

`pytest.ini` æ–‡ä»¶å·²æ›´æ–°ä¸ºæŒ‡å‘æ–°çš„æµ‹è¯•ç›®å½•ï¼š

```ini
[tool:pytest]
# æµ‹è¯•å‘ç°
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
```

## ğŸ‰ éªŒè¯æ–°ç»“æ„

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ–°ç»“æ„å·¥ä½œæ­£å¸¸ï¼š

```bash
# éªŒè¯å•å…ƒæµ‹è¯•
./run_tests.sh unit

# éªŒè¯APIæµ‹è¯•
python -m pytest tests/test_api.py::TestAPI::test_register_success -v

# éªŒè¯æ‰€æœ‰æµ‹è¯•
python -m pytest -v
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. **æµ‹è¯•æ–‡ä»¶ç»„ç»‡**
```
tests/
â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ conftest.py             # å…±äº«é…ç½®
â”œâ”€â”€ test_unit/              # å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰å­ç›®å½•ï¼‰
â”œâ”€â”€ test_integration/       # é›†æˆæµ‹è¯•ï¼ˆå¯é€‰å­ç›®å½•ï¼‰
â””â”€â”€ test_e2e/              # ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆå¯é€‰å­ç›®å½•ï¼‰
```

### 2. **æµ‹è¯•å‘½åè§„èŒƒ**
- æµ‹è¯•æ–‡ä»¶: `test_<module_name>.py`
- æµ‹è¯•ç±»: `Test<ClassName>`
- æµ‹è¯•æ–¹æ³•: `test_<function_name>`

### 3. **å¯¼å…¥è§„èŒƒ**
- ç»Ÿä¸€çš„è·¯å¾„å¤„ç†
- æ¸…æ™°çš„æ¨¡å—å¯¼å…¥
- é¿å…å¾ªç¯å¯¼å…¥

## ğŸ”§ å¼€å‘å·¥ä½œæµ

### 1. **æ·»åŠ æ–°æµ‹è¯•**
```bash
# åœ¨ tests/ ç›®å½•ä¸‹åˆ›å»ºæ–°æµ‹è¯•æ–‡ä»¶
touch tests/test_new_feature.py

# æ·»åŠ å¿…è¦çš„å¯¼å…¥å’Œæµ‹è¯•
# è¿è¡Œæµ‹è¯•éªŒè¯
python -m pytest tests/test_new_feature.py -v
```

### 2. **è°ƒè¯•æµ‹è¯•**
```bash
# è¯¦ç»†è¾“å‡º
python -m pytest tests/test_api.py -v -s

# åœ¨å¤±è´¥æ—¶è¿›å…¥è°ƒè¯•å™¨
python -m pytest tests/test_api.py --pdb

# åªè¿è¡Œå¤±è´¥çš„æµ‹è¯•
python -m pytest --lf
```

## ğŸ¯ æ€»ç»“

é‡æ–°ç»„ç»‡åçš„æµ‹è¯•ç»“æ„å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

âœ… **æ ‡å‡†åŒ–** - ç¬¦åˆPythoné¡¹ç›®æœ€ä½³å®è·µ  
âœ… **æ¸…æ™°æ€§** - æµ‹è¯•ä»£ç ä¸ä¸šåŠ¡ä»£ç åˆ†ç¦»  
âœ… **å¯ç»´æŠ¤æ€§** - æ›´å®¹æ˜“ç®¡ç†å’Œæ‰©å±•  
âœ… **ä¸“ä¸šæ€§** - æ›´ç¬¦åˆå·¥ä¸šæ ‡å‡†  
âœ… **å·¥å…·å‹å¥½** - æ›´å¥½çš„IDEå’ŒCI/CDæ”¯æŒ  

**è¿™ç§ç»“æ„æ›´é€‚åˆé•¿æœŸç»´æŠ¤å’Œå›¢é˜Ÿåä½œï¼** ğŸš€
